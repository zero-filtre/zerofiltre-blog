<main class="text-skin-art min-h-screen">
    <div *ngIf="course$|async as course" class="content">
        <div class="page-title site-container py-8 lg:pt-14 text-center space-y-5 lg:max-w-7xl mx-auto">
            <h1>{{course?.title}}</h1>
            <h2>{{course?.subTitle}}</h2>
        </div>

        <ng-container *ngFor="let section of course?.sections; let i = index">
            <section class="section py-6 lg:py-12 site-container flex flex-col lg:flex-row justify-between">
                <div [ngClass]="{'lg:order-1': i/2 === 0}"
                    class="why-text order-2 lg:basis-1/2 xl:basis-2/3 text-center lg:text-left flex flex-col lg:mx-0 mt-8 sm:mt-9 lg:mt-0 lg:px-2">
                    <h3>{{section.title}}</h3>

                    <markdown
                        class="prose lg:prose-xl prose-p:text-lg lg:prose-p:text-xl max-w-none text-secondary prose-headings:font-bold prose-headings:text-secondary prose-a:text-primary-500 prose-code:bg-gray-900 prose-code:rounded-md prose-code:text-accent-300 prose-code:font-normal prose-code:before:hidden prose-code:after:hidden prose-ul:list-disc prose-ol:list-disc"
                        [data]="section?.content">
                    </markdown>
                </div>

                <div [ngClass]="{'lg:order-2': i/2 === 0}" class="why-image m-auto order-1 lg:basis-1/2 xl:basis-1/3">
                    <app-image [classes]="'m-auto object-contain w-auto sm:max-w-[50%] lg:max-w-full'"
                        [sourceUrl]="section?.image" [alt]="section?.title">
                    </app-image>
                </div>
            </section>

            <div class="reactions py-10 border bg-secondary grid place-items-center border-skin-border">
                <!-- *ngIf="!loading && (isPublished$ | async)" -->
                <div class="reactions-container mt-5 flex flex-wrap justify-center lg:justify-start gap-10">
                    <button *ngFor="let reaction of typesOfReactions" (click)="addReaction(reaction.action)"
                        class="group flex items-center justify-center transition-all duration-300"
                        attr.aria-label="{{reaction.action}} button">
            
                        <div
                            class="reaction-wrapper flex flex-col gap-5 group-hover:-translate-y-2 transition-all ease-in duration-200">
                            <ng-container *ngIf="reaction.action === 'clap'">
                                <div class="group-hover:scale-[4] scale-[3.5] transition-all ease-in duration-200">
                                    {{reaction.emoji}}
                                </div>
                                <div class="text-lg font-semibold text-skin-link">
                                    {{clapReactions$ | async}}
                                </div>
                            </ng-container>
                            <ng-container *ngIf="reaction.action === 'fire'">
                                <div class="group-hover:scale-[4] scale-[3.5] transition-all ease-in duration-200">
                                    {{reaction.emoji}}
                                </div>
                                <div class="text-lg font-semibold text-skin-link">
                                    {{fireReactions$ | async}}
                                </div>
                            </ng-container>
                            <ng-container *ngIf="reaction.action === 'love'">
                                <div class="group-hover:scale-[4] scale-[3.5] transition-all ease-in duration-200">
                                    {{reaction.emoji}}
                                </div>
                                <div class="text-lg font-semibold text-skin-link">
                                    {{loveReactions$ | async}}
                                </div>
                            </ng-container>
                            <ng-container *ngIf="reaction.action === 'like'">
                                <div class="group-hover:scale-[4] scale-[3.5] transition-all ease-in duration-200">
                                    {{reaction.emoji}}
                                </div>
                                <div class="text-lg font-semibold text-skin-link">
                                    {{likeReactions$ | async}}
                                </div>
                            </ng-container>
                        </div>
                    </button>
                </div>
            
                <ng-container *ngIf="loading" class="articleReactionButtonsSkeletonLoader">
                    <ngx-skeleton-loader class="space-x-2" count="4" appearance="line"
                        [theme]="{ 
                                                                                                                                                                                                                                                                                                                                                                                                                                                    'border-radius': '5px',
                                                                                                                                                                                                                                                                                                                                                                                                                                                        height: '20px',
                                                                                                                                                                                                                                                                                                                                                                                                                                                        width: '20px'
                                                                                                                                                                                                                                                                                                                                                                                                                                                    }">
                    </ngx-skeleton-loader>
                </ng-container>
            
                <!-- <div *ngIf="loginToAddReaction"
                                                                                                                                                                                                                                                                                                                                                                                                        class="mt-4 text-sm font-medium px-4 py-2 bg-skin-link text-secondary shadow-md rounded-lg">
                                                                                                                                                                                                                                                                                                                                                                                                        {{ 'articleDetail.loginToReactText' | translate }}
                                                                                                                                                                                                                                                                                                                                                                                                    </div>
                                                                                                                                                                                                                                                                                                                                                                                                    <div *ngIf="!loading && !(isPublished$ | async)"
                                                                                                                                                                                                                                                                                                                                                                                                        class="mt-4 text-sm font-medium px-4 py-2 text-secondary text-center">
                                                                                                                                                                                                                                                                                                                                                                                                        {{ 'articleDetail.publishToReactText' | translate }}
                                                                                                                                                                                                                                                                                                                                                                                                    </div> -->
            </div>

            <section *ngIf="i==0" class="practical-video-section section py-6 lg:py-12">
                <div class="site-container flex flex-col items-center">
                    <iframe class="w-full lg:w-3/4 lg:h-[500px] rounded-[5px]" width="560" height="315"
                        [src]="course.video|url" title="YouTube video player"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen>
                    </iframe>
                </div>
            </section>

            <section class="section py-6 lg:py-12" *ngIf="i==course?.sections.length-1">
                <app-curriculum [chapters]="chapters$|async" [lessons]="lessons$|async" [course]="course"
                    [canAccessCourse]="canAccessCourse"></app-curriculum>
            </section>
        </ng-container>

        <button (click)="subscribeToCourse()"
            class="my-10 w-fit mx-auto flex items-center justify-center gap-2 px-4 py-2.5 rounded-md shadow-sm bg-primary-500 text-white font-normal hover:bg-primary-700 transition-all duration-300">
            <span class="text-center">Acheter ce cours</span>

            <span class="mt-1">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden md:block" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor" stroke-width="1.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                </svg>
            </span>
        </button>
    </div>
</main>