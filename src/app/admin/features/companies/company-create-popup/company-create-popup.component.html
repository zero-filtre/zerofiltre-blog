<div *ngIf="loading; else popupContent">
    <svg class="w-20 h-20 animate-spin text-primary-500" xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink" width="200px" height="200px" viewBox="0 0 100 100"
        preserveAspectRatio="xMidYMid">
        <circle cx="50" cy="50" fill="none" stroke="currentColor" stroke-width="8" r="35"
            stroke-dasharray="164.93361431346415 56.97787143782138" transform="matrix(1,0,0,1,0,0)"
            style="animation-play-state:paused"></circle>
    </svg>
</div>

<ng-template #popupContent>
    <div class="content">
        <div class="flex flex-col gap-5">
            <!-- Champ Nom de l'organisation -->
            <div>
                <input name="companyName" id="companyName" required minlength="4"
                    class="w-full bg-transparent border-b border-skin-border !pb-2 focus:outline-none placeholder:text-skin-muted text-secondary text-xl sm:text-2xl lg:text-5xl font-semibold placeholder:font-extrabold placeholder:text-xl sm:placeholder:text-2xl lg:placeholder:text-5xl focus:border-b-skin-borderBold"
                    placeholder="Nom de l'organisation" [(ngModel)]="companyName" #companyNameModel="ngModel" autocomplete="off" />
        
                <div *ngIf="companyNameModel.invalid && companyNameModel.dirty">
                    <div *ngIf="companyNameModel.errors?.['required']" class="mt-2 text-xs sm:text-sm text-error italic">
                        Veuillez entrer un nom
                    </div>
                    <div *ngIf="companyName?.trim() && companyNameModel.errors?.['minlength']"
                        class="mt-2 text-xs sm:text-sm text-error italic">
                        Veuillez entrer au moins 4 caractères
                    </div>
                </div>
        
                <div *ngIf="companyName?.length && !companyName?.trim() && companyNameModel.dirty">
                    <div class="mt-2 text-xs sm:text-sm text-error italic">
                        Veuillez insérer un nom valide.
                    </div>
                </div>
            </div>
        
            <!-- Champ Siren -->
            <div>
                <input name="siren" id="siren" required minlength="9" pattern="^\d{9}$"
                    class="w-full bg-transparent border-b border-skin-border !pb-2 focus:outline-none placeholder:text-skin-muted text-secondary text-xl sm:text-2xl lg:text-5xl font-semibold placeholder:font-extrabold placeholder:text-xl sm:placeholder:text-2xl lg:placeholder:text-5xl focus:border-b-skin-borderBold"
                    placeholder="Siren de l'organisation" [(ngModel)]="siren" #sirenModel="ngModel" autocomplete="off" />
        
                <div *ngIf="sirenModel.invalid && sirenModel.dirty">
                    <div *ngIf="sirenModel.errors?.['required']" class="mt-2 text-xs sm:text-sm text-error italic">
                        Veuillez entrer un numéro de Siren
                    </div>
                    <div *ngIf="sirenModel.errors?.['pattern']" class="mt-2 text-xs sm:text-sm text-error italic">
                        SIREN invalide, il doit contenir exactement 9 chiffres.
                    </div>
                </div>
                <div *ngIf="siren?.length && !siren?.trim() && sirenModel.dirty ">
                    <div class="mt-2 text-xs sm:text-sm text-error italic">
                        Veuillez insérer un Siren valide.
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-2 text-xs sm:text-sm text-skin-muted font-light italic space-x-2">
            <span>
                Vous pourrez le modifier à tout moment lors de l'édition de votre organisation
            </span>
        </div>

        <div class="action-buttons flex space-x-1 sm:space-x-2 mt-4">
            <button aria-labelledby="cancel"
                class="px-4 py-2 border border-skin-border rounded-full shadow-sm bg-skin-card text-sm leading-5 font-semibold text-skin-base hover:bg-skin-cardMuted focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-body focus:ring-primary-500 transition-all duration-200"
                (click)="onNoClick()">
                {{'app.cancel' | translate}}
            </button>

            <div *ngIf="companyNameModel.invalid || !companyName?.trim() || sirenModel.invalid || !siren?.trim(); else validBtn">
                <button aria-labelledby="create an article"
                    class="px-4 py-2 border border-primary-500 shadow-sm bg-primary-500 opacity-[0.15] rounded-full text-sm text-white leading-5 font-semibold"
                    type="submit" disabled>
                    {{'articleEntryPopup.createBtn' | translate}}
                </button>
            </div>
            <ng-template #validBtn>
                <button type="submit" aria-labelledby="create an article" (click)="handleCourseInit()"
                    class="px-4 py-2 border border-primary-500 rounded-full shadow-sm bg-primary-500 text-sm leading-5 font-semibold text-white hover:text-primary-500 hover:bg-skin-cardMuted hover:border-primary-500 focus:outline-none focus:ring-offset-2 focus:ring-primary-500 focus:border-skin-border transition-all duration-200">
                    {{'articleEntryPopup.createBtn' | translate}}
                </button>
            </ng-template>
        </div>
    </div>
</ng-template>